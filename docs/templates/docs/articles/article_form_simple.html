{% extends 'docs/base.html' %}
{% load static %}

{% block title %}–ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è - –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π{% endblock %}

{% block extra_css %}
{{ form.media.css }}
<style>
    .editor-guide {
        background: #f8f9fa;
        border-left: 4px solid #007bff;
        padding: 1rem;
        margin-bottom: 1.5rem;
        border-radius: 0 5px 5px 0;
    }

    .format-tips {
        background: #e7f3ff;
        padding: 1rem;
        border-radius: 5px;
        margin-bottom: 1.5rem;
    }

    .format-tips h6 {
        color: #0056b3;
        margin-bottom: 0.5rem;
    }

    .tip-item {
        margin-bottom: 0.3rem;
        font-size: 0.9em;
    }
</style>
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>
                <i class="bi bi-journal-plus"></i>
                –ù–æ–≤–∞—è —Å—Ç–∞—Ç—å—è
            </h1>
            <a href="{% url 'docs:article_list' %}" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left"></i> –û—Ç–º–µ–Ω–∞
            </a>
        </div>

        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é -->
        <div class="format-tips">
            <h6><i class="bi bi-lightbulb"></i> –°–æ–≤–µ—Ç—ã –ø–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:</h6>
            <div class="row">
                <div class="col-md-6">
                    <div class="tip-item"><strong>–ó–∞–≥–æ–ª–æ–≤–∫–∏:</strong> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ H1, H2, H3</div>
                    <div class="tip-item"><strong>–ñ–∏—Ä–Ω—ã–π —Ç–µ–∫—Å—Ç:</strong> –í—ã–¥–µ–ª–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ <strong>B</strong></div>
                    <div class="tip-item"><strong>–ö—É—Ä—Å–∏–≤:</strong> –í—ã–¥–µ–ª–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ <em>I</em></div>
                </div>
                <div class="col-md-6">
                    <div class="tip-item"><strong>–°–ø–∏—Å–∫–∏:</strong> –ö–Ω–æ–ø–∫–∏ —Å —Ç–æ—á–∫–∞–º–∏ –∏ —Ü–∏—Ñ—Ä–∞–º–∏</div>
                    <div class="tip-item"><strong>–°—Å—ã–ª–∫–∏:</strong> –ö–Ω–æ–ø–∫–∞ —Å —Ü–µ–ø–æ—á–∫–æ–π üîó</div>
                    <div class="tip-item"><strong>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:</strong> –ö–Ω–æ–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º üñºÔ∏è</div>
                </div>
            </div>
        </div>

        <div class="text-center mb-4">
            <small class="text-muted">
                –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?
                <a href="{% url 'docs:formatting_help' %}" class="text-decoration-none">
                    –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
                </a>
            </small>
        </div>
        <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-info-circle"></i> –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="mb-3">
                                <label class="form-label fw-bold">–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏ *</label>
                                {{ form.title }}
                                <div class="form-text text-muted">{{ form.title.help_text }}</div>
                            </div>
                        </div>

                        <div class="col-md-4">
                            <div class="mb-3">
                                <label class="form-label fw-bold">–ö–∞—Ç–µ–≥–æ—Ä–∏—è *</label>
                                {{ form.category }}
                                <div class="form-text text-muted">{{ form.category.help_text }}</div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-bold">–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
                        {{ form.excerpt }}
                        <div class="form-text text-muted">{{ form.excerpt.help_text }}</div>
                    </div>
                </div>
            </div>

            <!-- –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ -->
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0"><i class="bi bi-journal-text"></i> –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ *</h5>
                </div>
                <div class="card-body">
                    <div class="editor-guide">
                        <strong>üí° –ü—Ä–æ—Å—Ç–æ –ø–∏—à–∏—Ç–µ —Ç–µ–∫—Å—Ç - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ª–∞–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞–º–∏!</strong>
                        <br>–ù–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å Markdown - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤—ã—à–µ.
                    </div>

                    <div class="mb-3">
                        {{ form.content }}
                        <div class="form-text text-muted">{{ form.content.help_text }}</div>
                    </div>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ -->
            <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                <button type="submit" class="btn btn-success btn-lg">
                    <i class="bi bi-check-circle"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å—é
                </button>
                <a href="{% url 'docs:article_list' %}" class="btn btn-outline-secondary btn-lg">
                    –û—Ç–º–µ–Ω–∞
                </a>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{{ form.media.js }}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ü—Ä–æ—Å—Ç—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
    const titleField = document.querySelector('#id_title');
    if (titleField) {
        titleField.addEventListener('focus', function() {
            console.log('–ù–∞–ø–∏—à–∏—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤–ª–µ—á–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ');
        });
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
    const form = document.querySelector('form');
    if (form) {
        form.addEventListener('submit', function(e) {
            const title = document.querySelector('#id_title').value.trim();
            const content = document.querySelector('#id_content').value.trim();
            const category = document.querySelector('#id_category').value;

            if (!title) {
                e.preventDefault();
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏');
                return false;
            }

            if (!content) {
                e.preventDefault();
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞–ø–∏—à–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏');
                return false;
            }

            if (!category) {
                e.preventDefault();
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é');
                return false;
            }
        });
    }
});
</script>
{% endblock %}